# Patch Notes: 2026-02-25 - Verilog Benchmark Evaluator Fix

## Critical Fixes

*   **Fixed evaluator file-path vs code-content mismatch**: OpenEvolve's evaluator framework passes a **file path** to `evaluate()`, but all 156 `verilog_eval/Prob*/evaluator.py` files treated the input as raw Verilog code. This caused every generated program to be written as a one-line file containing a path string (e.g., `/tmp/verilog_abc.v`), resulting in `syntax error` on line 1 and `0.0000` scores across all benchmark problems. Fixed by adding `os.path.exists(code)` detection to read file contents when a path is passed.
*   **Fixed testbench relative path failure**: Evaluators used relative paths (`testbench.sv`, `ref.sv`) which only resolved when the working directory was the problem folder. OpenEvolve worker processes run from the project root, causing `testbench.sv: No such file or directory`. Fixed by resolving paths relative to the evaluator's own `__file__` location using `os.path.dirname(os.path.abspath(__file__))`.
*   **Fixed silent iverilog error swallowing**: The bare `except Exception as e` block discarded iverilog's stderr output, giving the LLM no actionable feedback on compilation failures. Replaced with a targeted `except subprocess.CalledProcessError` that decodes and returns `e.output`.

## Improvements

*   **Partial-credit scoring**: Evaluators now return graduated scores on compilation failure instead of flat `0.0`, giving evolution a gradient signal:
    *   `0.00` — garbage / empty code
    *   `0.05` — has `module` keyword (valid Verilog structure)
    *   `0.10` — has `TopModule` (correct module name)
    *   `0.15` — compiles but runtime error
*   **Novelty LLM None guard**: Added a `None` check in `database.py` → `_llm_judge_novelty()` to prevent `AttributeError` spam when the controller releases LLM resources for worker VRAM.

## Modified Files

*   `examples/verilog_eval/Prob*/evaluator.py` (all 156 files) — batch-updated via `scripts/fix_evaluators.py`
*   `openevolve/database.py` — novelty LLM guard
*   `scripts/fix_evaluators.py` — new batch update utility
