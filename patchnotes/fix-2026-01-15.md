# Feature: Early Stopping & Checkpoint Logic Fix (2026-01-15)

## Summary
Implemented comprehensive early stopping functionality for the evolutionary process, allowing runs to terminate based on score targets or stagnation. Also fixed a bug in the checkpointing logic where the final checkpoint number was incorrectly calculated based on planned rather than actual iterations.

## Changes

### `openevolve/config.py` & `openevolve/cli.py`
*   **Added Early Stopping Configuration**:
    *   Exposed `target_score`, `early_stopping_patience`, `convergence_threshold`, and `early_stopping_metric` in `Config` and CLI arguments.
    *   Updated `gemma_config.yaml` to include templates for these settings.

### `openevolve/controller.py`
*   **Target Score Logic**:
    *   Updated `run()` to respect `target_score` configured in YAML/Config object if not explicitly passed via arguments.
*   **Fixed Checkpoint Numbering Bug**:
    *   Modified `_run_evolution_with_checkpoints` to use `self.database.last_iteration` for the final checkpoint save instead of calculating it from `start + max_iterations`. This ensures that when early stopping triggers (e.g., at iteration 254), the checkpoint is correctly named `checkpoint_254` instead of a future iteration number (e.g., `checkpoint_350`).

## Impact
*   Users can now configure runs to stop automatically when a solution is "good enough" (`target_score`) or when progress stalls (`early_stopping_patience`).
*   Checkpoints are now correctly named matching the actual iteration count, eliminating confusion about run progress.
